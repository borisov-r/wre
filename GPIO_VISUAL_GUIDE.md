# Rotary Encoder GPIO Configuration - Visual Guide

## System Architecture

```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                         ESP32 GPIO System                               β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚                                                                          β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”     β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”     β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”           β”‚
β”‚  β”‚   HAL Layer  β”‚β”€β”€β”€β”€β–¶β”‚  ESP-IDF API β”‚β”€β”€β”€β”€β–¶β”‚   Hardware   β”‚           β”‚
β”‚  β”‚  (PinDriver) β”‚     β”‚ (gpio_set_*) β”‚     β”‚   Registers  β”‚           β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”     β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”     β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”           β”‚
β”‚         β”‚                     β”‚                     β”‚                   β”‚
β”‚         β”‚                     β”‚                     β”‚                   β”‚
β”‚         β–Ό                     β–Ό                     β–Ό                   β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”             β”‚
β”‚  β”‚              GPIO21 (CLK) Configuration               β”‚             β”‚
β”‚  β”‚  β€Ά Direction: INPUT                                   β”‚             β”‚
β”‚  β”‚  β€Ά Pull Mode: PULLUP_ONLY (45kΞ© internal)           β”‚             β”‚
β”‚  β”‚  β€Ά Interrupt: AnyEdge                                β”‚             β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”             β”‚
β”‚                                                                          β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”             β”‚
β”‚  β”‚              GPIO22 (DT) Configuration                β”‚             β”‚
β”‚  β”‚  β€Ά Direction: INPUT                                   β”‚             β”‚
β”‚  β”‚  β€Ά Pull Mode: PULLUP_ONLY (45kΞ© internal)           β”‚             β”‚
β”‚  β”‚  β€Ά Interrupt: AnyEdge                                β”‚             β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”             β”‚
β”‚                                                                          β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

## Configuration Flow

### Before Fix (HAL Only)
```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚ PinDriver::  β”‚
β”‚   input()    β”‚β”€β”€β”€β”€β”€β–¶ Pin configured as input
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
       β”‚
       β–Ό
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚ set_pull()   β”‚β”€β”€β”€β”€β”€β–¶ Pull-up requested
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
       β”‚
       β–Ό
    β“ Issue: Pull-up may not be applied at hardware level
```

### After Fix (HAL + ESP-IDF)
```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚ PinDriver::  β”‚
β”‚   input()    β”‚β”€β”€β”€β”€β”€β–¶ Pin configured as input (HAL)
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
       β”‚
       β–Ό
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚ set_pull()   β”‚β”€β”€β”€β”€β”€β–¶ Pull-up requested (HAL)
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
       β”‚
       β–Ό
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚ gpio_set_    β”‚
β”‚ direction()  β”‚β”€β”€β”€β”€β”€β–¶ Explicitly set INPUT (ESP-IDF)
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
       β”‚
       β–Ό
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚ gpio_set_    β”‚
β”‚ pull_mode()  β”‚β”€β”€β”€β”€β”€β–¶ Explicitly enable PULLUP (ESP-IDF)
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
       β”‚
       β–Ό
    β… Pull-up guaranteed at hardware level
```

## Debug Output Flow

### Serial Output Sequence

```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                        ESP32 Boot                                β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
                             β”‚
                             β–Ό
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚  I (1234) wre: Rotary encoder task running on Core 1           β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
                             β”‚
                             β–Ό
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚  [Configure pins with HAL]                                      β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
                             β”‚
                             β–Ό
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚  [Apply explicit ESP-IDF configuration]                         β”‚
β”‚  I (1235) wre: β“ GPIO pins explicitly configured               β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
                             β”‚
                             β–Ό
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚  [Read and verify pin states]                                   β”‚
β”‚  I (1236) wre: π“ CLK: HIGH (1), DT: HIGH (1)                  β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
                             β”‚
                             β–Ό
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚  [User enables debug mode via web interface]                   β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
                             β”‚
                             β–Ό
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚  [Live pin monitoring begins]                                   β”‚
β”‚  I (2000) wre: π” DEBUG (Live): CLK=1 DT=1 ...                β”‚
β”‚  I (2200) wre: π” DEBUG (Live): CLK=1 DT=1 ...                β”‚
β”‚  I (2400) wre: π” DEBUG (Live): CLK=1 DT=1 ...                β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
                             β”‚
                             β–Ό
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚  [User rotates encoder]                                         β”‚
β”‚  I (2600) wre: π” DEBUG (Live): CLK=0 DT=1 ...                β”‚
β”‚  I (2650) wre: π” DEBUG (Live): CLK=0 DT=0 ...                β”‚
β”‚  I (2700) wre: π” DEBUG (Live): CLK=1 DT=0 ...                β”‚
β”‚  I (2750) wre: π” DEBUG (Live): CLK=1 DT=1 ...                β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

## Pin State Machine

### Rotary Encoder Rotation (Clockwise)

```
State: R_START (0x00)
β”β”€β”€β”€β”€β”€β”
β”‚ CLK β”‚  1 β”€β”€β”€β”€β”€β”€β”€β”€β”€β”           β”β”€β”€β”€β”€β”€β”€β”€β”€β”€ 1
β”‚     β”‚             β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β””β”€β”€β”€β”€β”€β”

β”β”€β”€β”€β”€β”€β”
β”‚ DT  β”‚  1 β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”       β”β”€β”€β”€β”€ 1
β”‚     β”‚                     β””β”€β”€β”€β”€β”€β”€β”€β”
β””β”€β”€β”€β”€β”€β”

Transitions: 0x00 β†’ 0x01 β†’ 0x12 β†’ 0x03 β†’ 0x10 β†’ ...
               β†‘      β†‘      β†‘      β†‘      β†‘
             START  CW_1   CW_2   CW_3   CW_DIR
```

### What Debug Output Shows

```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚ π” DEBUG (Live): CLK=1 DT=1 State=0x00 Value=0 Angle=0.0Β°  β”‚
β”‚                   β”‚   β”‚        β”‚         β”‚         β”‚        β”‚
β”‚                   β”‚   β”‚        β”‚         β”‚         β””β”€β”€Calculated angle
β”‚                   β”‚   β”‚        β”‚         β””β”€β”€Raw half-steps
β”‚                   β”‚   β”‚        β””β”€β”€State machine value
β”‚                   β”‚   β””β”€β”€DT pin (0=LOW, 1=HIGH)
β”‚                   β””β”€β”€CLK pin (0=LOW, 1=HIGH)
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

## Troubleshooting Decision Tree

```
                    Pins not responding?
                            β”‚
                            β–Ό
              β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
              β”‚ Check initial states    β”‚
              β”‚ Should show HIGH (1)    β”‚
              β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
                     β”‚              β”‚
              Both HIGH?        One/Both LOW?
                     β”‚              β”‚
                     β–Ό              β–Ό
              β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
              β”‚   GOOD    β”‚  β”‚ Pull-ups not β”‚
              β”‚ Proceed β†’ β”‚  β”‚   working    β”‚
              β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
                     β”‚              β”‚
                     β–Ό              β–Ό
              β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
              β”‚  Rotate   β”‚  β”‚ Check wiring β”‚
              β”‚  encoder  β”‚  β”‚ or add ext.  β”‚
              β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β”‚  resistors   β”‚
                     β”‚       β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
          Pins change? β”‚
                     β”‚
              Yes β”€β” β”‚ β”β”€ No
                   β”‚ β”‚ β”‚
                   β–Ό β–Ό β–Ό
          β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
          β”‚    SUCCESS!     β”‚  β”‚ Check encoderβ”‚
          β”‚ Encoder working β”‚  β”‚  or wiring   β”‚
          β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

## Hardware Connection Diagram

```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                      ESP32 Board                              β”‚
β”‚                                                               β”‚
β”‚   GPIO21 (CLK) β—„β”€β”€β”€β”€β”€β”€ CLK β”€β”€β”€β”€β”€β”€β”€β”€β”€β”                       β”‚
β”‚                                      β”‚                        β”‚
β”‚   GPIO22 (DT)  β—„β”€β”€β”€β”€β”€β”€ DT  β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤  Rotary Encoder      β”‚
β”‚                                      β”‚   (KY-040 or         β”‚
β”‚   GPIO32 (OUT) β”€β”€β”€β”€β”€β”€β”€β”€β–¶ (Optional) β”‚    similar)          β”‚
β”‚                                      β”‚                        β”‚
β”‚   GND          β”€β”€β”€β”€β”€β”€β”€β”€β–¶ GND β”€β”€β”€β”€β”€β”€β”€β”                       β”‚
β”‚                                                               β”‚
β”‚   3.3V         β”€β”€β”€β”€β”€β”€β”€β”€β–¶ VCC (if needed)                    β”‚
β”‚                                                               β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”

Internal Pull-ups (45kΞ©):
  GPIO21 β”€β”
           β”β”€ 3.3V
  GPIO22 β”€β”

When encoder is idle:
  CLK = HIGH (1)  β† pulled up by internal resistor
  DT  = HIGH (1)  β† pulled up by internal resistor

When encoder rotates:
  CLK and DT alternate between HIGH and LOW
  as encoder makes/breaks connections
```

## Implementation Timeline

```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚ Commit 1: Add explicit GPIO configuration                   β”‚
β”‚           + gpio_set_direction()                            β”‚
β”‚           + gpio_set_pull_mode()                            β”‚
β”‚           + Initial state verification                       β”‚
β”‚           + Live debug monitoring                           β”‚
β”‚           [41 lines in src/main.rs]                         β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
                             β”‚
                             β–Ό
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚ Commit 2: Add comprehensive documentation                   β”‚
β”‚           + GPIO_PIN_FIX.md (214 lines)                     β”‚
β”‚           + Updated DEBUG_MODE.md (10 lines)                β”‚
β”‚           [Technical details and troubleshooting]           β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
                             β”‚
                             β–Ό
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚ Commit 3: Add executive summary                             β”‚
β”‚           + GPIO_FIX_SUMMARY.md (204 lines)                 β”‚
β”‚           [High-level overview and verification]            β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
                             β”‚
                             β–Ό
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚ Total Impact:                                                β”‚
β”‚   β€Ά 4 files changed                                         β”‚
β”‚   β€Ά 469 lines added                                         β”‚
β”‚   β€Ά 0 lines deleted                                         β”‚
β”‚   β€Ά Complete solution with documentation                    β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

## Success Metrics

### β… Configuration Success
- GPIO direction set to INPUT
- Pull-up mode set to PULLUP_ONLY
- Initial states read HIGH (1)
- Log message confirms configuration

### β… Operation Success
- Pins alternate between 0 and 1 when rotating
- State machine transitions correctly
- Value and angle change with rotation
- No stuck pins or constant values

### β… Documentation Success
- Comprehensive troubleshooting guide
- Clear diagnostic procedures
- Hardware testing instructions
- Reference information available

## Key Files Reference

```
wre/
β”β”€β”€ src/
β”‚   β””β”€β”€ main.rs ........................ Core implementation (253 lines)
β”‚
β”β”€β”€ GPIO_PIN_FIX.md .................... Technical deep dive (214 lines)
β”β”€β”€ GPIO_FIX_SUMMARY.md ................ Executive summary (204 lines)
β”β”€β”€ DEBUG_MODE.md ...................... Debug mode guide (110 lines)
β””β”€β”€ GPIO_VISUAL_GUIDE.md ............... This file (visual guide)
```

## Quick Reference Commands

### View Serial Output
```bash
# Linux/Mac
screen /dev/ttyUSB0 115200

# Windows (PuTTY)
putty -serial COM3 -serspeed 115200

# Platform.io
pio device monitor --baud 115200
```

### Expected Success Output
```
β“ GPIO pins explicitly configured as INPUT with PULL-UP
π“ Pin configuration verified - CLK: HIGH (1), DT: HIGH (1)
π” DEBUG (Live): CLK=1 DT=1 State=0x00 Value=0 Angle=0.0Β°
```

### Troubleshooting Commands
```bash
# Check GPIO registers (requires esp-idf tools)
idf.py monitor

# Read pin values
gpio_get_level(21)  # CLK
gpio_get_level(22)  # DT
```

---

**Note**: This visual guide complements the technical documentation in GPIO_PIN_FIX.md and GPIO_FIX_SUMMARY.md. Refer to those files for detailed implementation notes and troubleshooting procedures.
